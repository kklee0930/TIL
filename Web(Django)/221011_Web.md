### ğŸ’»Django Auth

íšŒì›ê°€ì…/ë¡œê·¸ì¸ì˜ í•„ìˆ˜ ë° ìš”êµ¬ì¡°ê±´ì´ ë¬´ì—‡ì¼ê¹Œ?

`Django authentication system`: ì¸ì¦ê³¼ ê¶Œí•œ ë¶€ì—¬ë¥¼ ì œê³µ(ì²˜ë¦¬)í•¨

- í•„ìˆ˜ êµ¬ì„±ì€ settings.pyì˜ INSTALLED_APPSì—ì„œ í™•ì¸ ê°€ëŠ¥


#### Django Auth ê°œìš”

- Authentication(ì¸ì¦): ì‹ ì›í™•ì¸, ëˆ„êµ°ì§€ í™•ì¸í•˜ëŠ” ê²ƒ

- Authorization(ê¶Œí•œ, í—ˆê°€): ê¶Œí•œ ë¶€ì—¬, ê¶Œí•œ ê°€ì§„ ì´ìš©ìê°€ ìˆ˜í–‰ê°€ëŠ¥í•œ ì‘ì—…ì„ ê²°ì •


##### ì‚¬ì „ì„¤ì •

1. ì‚¬ìš©ì ì •ë³´ë¥¼ ê´€ë¦¬í•˜ëŠ” accounts / ê²Œì‹œê¸€ì„ ê´€ë¦¬í•˜ëŠ” articles ìƒì„± ë° ë“±ë¡

```bash
# ì‹¤ìŠµ/django_project
$ python manage.py startapp accounts
$ python manage.py startapp articles
```

ì•± ìƒì„± í›„ì— INSTALLED_APPSì— ì¶”ê°€í•´ì£¼ì.

![](221011_Web.assets/install.png)


2. project í´ë”ì˜ urls.pyì— accountsì™€ articles, ê°ê° ì•±ì˜ ê²½ë¡œë¥¼ ì¶”ê°€í•´ì¤Œ(url ë¶„ë¦¬ ë° ë§¤í•‘ì„ ì§„í–‰í•œë‹¤)

![](221011_Web.assets/include.png)


#### Django User Model

- ìƒˆ í”„ë¡œì íŠ¸ ì‹œì‘ ì‹œ ì»¤ìŠ¤í…€ User ëª¨ë¸ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê°•ë ¥í•˜ê²Œ ê¶Œì¥

- ë‚˜ì¤‘ì— í•„ìš”í•œ ê²½ìš° ë§ì¶¤ ì„¤ì •í•  ìˆ˜ ìˆê¸° ë•Œë¬¸(ì˜ˆ: ì„±ë³„ ì¶”ê°€, ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€ ì‹œ)

- ëª¨ë“  model ëŒ€ì²´ ì‘ì—…ì€ migrate ì‹¤í–‰ ì „ì— ë§ˆì³ì•¼ í•¨


##### AUTH_USER_MODEL

ì»¤ìŠ¤í…€ ìœ ì € ëª¨ë¸ì„ ì‘ì„±í•´ë³´ì.

ëª¨ë¸ì€ ë‚´ë¶€ ëª¨ë¸ì„ ìƒì†ë°›ì•„ì„œ í™œìš©í•œë‹¤.

1. settings.pyì— ëª¨ë¸ ì •ì˜
```python
# project/settings.py
AUTH_USER_MODEL = 'accounts.User'
```

2. User class ì •ì˜
```python
# app/models.py
from django.db import models
from django.contrib.auth.models import AbstractUser

# Create your models here
class User(AbstractUser):
    pass
```


##### DBì´ˆê¸°í™” ì‹œ

1. migrationsíŒŒì¼ ì‚­ì œ

- migrationsí´ë” ë° __init__.pyëŠ” Xì‚­ì œ

- ë²ˆí˜¸ ë¶™ì€ íŒŒì¼ë§Œ ì‚­ì œ

2. db.sqlite3 ì‚­ì œ

3. migrations ì§„í–‰

- makemigrations ë° migrate ì§„í–‰


#### Articleì—ì„œ ìœ ì € ê²Œì‹œë¬¼ ìƒì„±

- django shell_plus ë‚´ì—ì„œ ì‹¤í–‰

```python
In [1]: Article.objects.create(title='ì œëª©1', content='ë‚´ìš©1')
Out[1]: <Article: Article object (1)>
# ì´ë ‡ê²Œ ì €ì¥í•˜ë©´ ê·¸ëŒ€ë¡œ ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆì— ë¬¸ì œê°€ ìƒê¸´ë‹¤! ë°˜ë“œì‹œ ì•”í˜¸í™”ë¥¼ í•´ì•¼í•¨
In [2]: User.objects.create(username='sun', content='1q2w3e4r')
Out[2]: <Article: Article object (2)>
```

â›”UserëŠ” ë°˜ë“œì‹œ ì•”í˜¸í™”í•˜ëŠ” ë¡œì§ì„ ì‚¬ìš©í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— createë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤!


##### ì•”í˜¸ê´€ë¦¬

1. ë‹¨ë°©í–¥ í•´ì‹œí•¨ìˆ˜

- Djangoì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ PBKDF2(Password-Based Key Derivation Function) ì‚¬ìš©í•´ì•¼í•¨

    - ì•”í˜¸í™”ê°€ í•„ìˆ˜ì„(ë‹¨ë°©í–¥ í•´ì‹œí•¨ìˆ˜ í™œìš©í•˜ì—¬ ë‹¤ì´ì œìŠ¤íŠ¸ë¡œ ì•”í˜¸í™”, ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥)

    ë‹¨ë°©í–¥ í•´ì‹œí•¨ìˆ˜ ì˜ˆ: SHA-1, SHA-256ë“±ì´ ì¡´ì¬í•˜ë©° DjangoëŠ” SHA-256í™œìš©

##### â›”ë‹¨ë°©í–¥ í•´ì‹œí•¨ìˆ˜ì˜ ì•½ì : 

    1. ë ˆì¸ë³´ìš° í…Œì´ë¸”: í•´ì‹œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë§Œë“¤ì–´ ë‚¼ ìˆ˜ ìˆëŠ” ê°’ì„ í…Œì´ë¸”ë¡œ ì •ë¦¬í•˜ì—¬ í•´í‚¹ì— í™œìš©

    2. ë¸Œë£¨íŠ¸í¬ìŠ¤: ë¬´ì°¨ë³„ ëŒ€ì… 

##### ğŸŒŸí•´í‚¹ ëŒ€ì²˜ë²•:

    ì†”íŒ…(ë ˆì¸ë³´ìš° í…Œì´ë¸” í•´í‚¹): input ê°’ ìì²´ì— ì¶”ê°€ì ì¸ ê°’ì„ ì…ë ¥í•˜ì—¬ í•´í‚¹ì„ ë°©ì§€

    keystretching(ë¸Œë£¨íŠ¸ í¬ìŠ¤): ì•Œê³ ë¦¬ì¦˜ì„ NíšŒ ëŒë ¤ì„œ inputì— ë°˜ì˜ ë¸Œë£¨íŠ¸í¬ìŠ¤ í™œìš©í•˜ì—¬ í•´í‚¹í•˜ëŠ” ë°ì— ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ë¹„ì•½ì ìœ¼ë¡œ ëŠ˜ë¦¼

#### User ê°ì²´ í™œìš©í•˜ì—¬ ìœ ì € ì •ë³´ ìƒì„± ë° ì €ì¥

1. `User.objects.create_user`ë¡œ ìœ ì € ì •ë³´ë¥¼ ì…ë ¥í•˜ì—¬ ìœ ì €ë¥¼ ìƒì„±í•œë‹¤.

2. `from django.contrib.auth import authenticate`ë¡œ authenticate ê¸°ëŠ¥ì„ import

3. `authenticate(username='[name]',password='[password]')`ê°€ ì¼ì¹˜í•˜ë©´ Userì •ë³´ë¥¼ ë°˜í™˜í•´ì£¼ê³  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì•„ë¬´ê²ƒë„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤.

![](221011_Web.assets/auth.png)


### ğŸ’»íšŒì›ê°€ì… êµ¬í˜„(ì‹¤ìŠµ)

1. accounts/urls.pyì— íšŒì›ê°€ì… ê¸°ëŠ¥ ì •ì˜

```python
# accounts/urls.py
from django.urls import path
from . import views

app_name = 'accounts'

urlpatterns = [
    path('signup/', views.signup, name='signup'),
]
```

2. accounts/views.pyì— view í•¨ìˆ˜ ì •ì˜(accounts/templates/accounts/signup.htmlìƒì„±)

```python

```






```python
# appname/urls.py
from django import path

```

```python
# appname/views.py
from django.shortcuts import render

def signup(request):
    return render(request, 'accounts/signup.html')
```

```python
# appname/templates/appname/signup.html
{% extends 'base.html' %}
{% block %}
<íšŒì›ê°€ì…>
{{form.as _p}}
{% endblock %}
```

```python
from django.shortcuts import render
from django.contrib.auth.forms import UserCreationForm

def signup(request):
    # POST ìš”ì²­ ì²˜ë¦¬
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            form.save()
            return redirect('articles.index')

    else:
        form = userCreationForm()
        context = {
            'form': form
            }
    return render(request, 'accounts/signup.html', context)
```