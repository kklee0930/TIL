### 💻Django Auth

회원가입/로그인의 필수 및 요구조건이 무엇일까?

Django authentication system: 인증과 권한 부여를 제공(처리)함

- 필수 구성은 settings.py의 INSTALLED_APPS에서 확인 가능


#### Django Auth 개요

- Authentication(인증): 신원확인, 누군지 확인하는 것

- Authorization(권한, 허가): 권한 부여, 권한 가진 이용자가 수행가능한 작업을 결정


#### Django User Model

- 새 프로젝트 시작 시 커스텀 User 모델 설정하는 것을 강력하게 권장

- 나중에 필요한 경우 맞춤 설정할 수 있기 때문

- 모든 model 대체 작업은 migrate 실행 전에 마쳐야 함


##### AUTH_USER_MODEL

1. settings.py에 모델 정의
```python
# project/settings.py
AUTH_USER_MODEL = 'accounts.User'
```

2. User class 정의
```python
# app/models.py
from django.db import models
from django.contrib.auth.models import AbstractUser

# Create your models here
class User(AbstractUser):
    pass
```


##### DB초기화

1. migrations파일 삭제

- migrations폴더는 X삭제

- 숫자 붙은 파일만 삭제

2. db.sqlite3 삭제

3. migrations 진행

- makemigrations 및 migrate 진행


#### Article 유저 게시물 생성

- django shell_plus 내에서 실행

```python
In [1]: Article.objects.create(title='제목1', content='내용1')
In [2]: User.objects.create(username='sun', content='1a2w3e4r')
```

⛔User는 반드시 암호화하는 로직을 사용해야하기 때문에 create를 사용하면 안된다!

##### 암호관리

- Django에서 기본적으로 PBKDF2(Password-Based Key Derivation Funciton) 사용해야함

    - 암호화가 필수임(단방향 해시함수 활용하여 다이제스트로 암호화, 복호화가 불가능)

    예: MD5, SHA-1, SHA-256등이 존재하며 Django는 SHA-256활용

솔팅

keystretching

```python
User.objects.create_user('kim', 'hong@gmail.com', '1234')

from django.contrib.auth import authenticate

authenticate(username='kim', password='1234')
Out[]: <User: kim>

# 틀리면 알려주지않는다.
```


```python
# appname/urls.py
from django import path

```

```python
# appname/views.py
from django.shortcuts import render

def signup(request):
    return render(request, 'accounts/signup.html')
```

```python
# appname/templates/appname/signup.html
{% extends 'base.html' %}
{% block %}
<회원가입>
{{form.as _p}}
{% endblock %}
```

```python
from django.shortcuts import render
from django.contrib.auth.forms import UserCreationForm

def signup(request):
    # POST 요청 처리
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            form.save()
            return redirect('articles.index')

    else:
        form = userCreationForm()
        context = {
            'form': form
            }
    return render(request, 'accounts/signup.html', context)
```